# Nails-Segmentation

**Dataset Preparation**
1. JPG Image of hands with nails was downloaded from the internet.
2. PNG label of respective images was prepared as labels for training the model. Labels were prepared using adobe photo studio
3. Dataset used to train this model was very small - less than 1000 images even after applying augmentation technique. We can achieve better result by increasing our dataset to around 1 lakh images.

**Data Processing**
Model was tested using label in both format - jpg and png. create data.py was used to convert labels from png to jpg by converting image into RGBA channel where 'A' is for alpha channel of the image which measures the transparency at a particular pixel.
JPG contains information in every pixel and no pixel is opaque while in png the opaque pixel does not contain any informaion. Thus, it is better to use png images in case of labels to train the model.

**Training Model**
Convolutional neural network is used to trained the model. We can increase the accuracy of the model by providing it with huge dataset and tweaking the hyper-parameters of the model.

**Execution**
1. Create a Dataset Folder -  having both images and corresponding labels. Name images as "abc.jpg" and labels as "abcnails.png".
2. Create 2 folder as Augmented Nails and Segmented Nails in the same directory.
3. Use Augmentation.py to increase the dataset and store the output in Augmented Nails and Segmented Nails.
4. Use im_to_numpy.py to convert the images in Augmented Nails and Segmented Nails into numpy array as "nails.npy" and "labels.npy" and save it in numpy folder in the same directory.
5. Provide the npy files as input to the training model and run train_gray_v2.py.
6. A folder "model_v2" will be created and weights generated by the model will be stored here.
7. Create a test_im folder and download some images to test the trained model on the these images.
8. Run test_gray_v2.py - provide images in the test_im folder as input.
9. A "result" folder will be created and the output with segmented nails of the test images will be stored here.
